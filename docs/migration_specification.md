# Whitehall Format migration specification

## content_id

Generated by and stored with the format in Whitehall.

Eg

```json
{ "content_id": "5eb731c7-7631-11e4-a3cb-005056011aef" }
```

## base_path

The format has a slug which is then used with URLMaker in Whitehall to create the base path.

Eg `"base_path": "/government/collections/national-driving-and-riding-standards"`

## description

Generated by and stored with the format in Whitehall.

Eg `"description": "The standards set out what it takes to be a safe and responsible driver and rider and provide training to drivers and riders."`

## public_updated_at

This is either the `public_timestamp` if the document has been published or `updated_at` if not. `CorporateInformationPage` weirdly have `public_timestamp` still set to nil despite having a `published` state.

Eg `"public_updated_at": "2016-02-29T09:24:10.000+00:00"`

## title

The title used for the main heading. Stored on the edition in Whitehall, either as `title` or `name`. `ComingSoon` pages all have the same hard coded title.

Eg `"title": "National standards for driving and riding",`

## updated_at

Generated by rails when the model is updated. This is not visible to end users in the frontend.

Eg `"updated_at": "2016-05-17T11:27:14.152Z"`

## schema_name

The schema to use for validating the format (see `govuk_content_schemas`).
It is also used to select the presenter and the template in `government_frontend`.

Eg `"schema_name": "document_collection"`

## document_type

The document_type is rendered above the title of the format. It is translated following the locale files.

Eg `"document_type": "document_collection"`

## format

**deprecated** 

## locale

Stored on the edition or set to `en` by default.

Eg `"locale": "en"`

## withdrawn_notice

Optional. Generated from the `Unpublishing` for withdrawn editions. This gets generated by the Publishing API when `/unpublish` is called with a request body that indicates the content item has been withdrawn.

## details

This contains the details for the content item. These differ by format and are defined by the schema.

## details.first_public_at

For a published document this is the first_public_at for the Edition.
For a draft this is set to `document.created_at`.

This should be deprecated when publishing API can define first published.

**this need discussion because the logic seems a bit odd**

## details.change_history

This is displayed at the bottom of the page. It is also used to derive the 'Last updated' value in the metadata component. This is generated from a `DocumentHistory` object associated with the `Edition`.

Eg

```
[
  {
    "public_timestamp": "2016-02-08T17:36:26+00:00",
    "note": "Liberia removed - Council Regulation (EC) No 872/2004 imposing financial sanctions against Liberia has been repealed with effect from 6 October 2015."
  },
  { ... }
]
```

## details.tags

**deprecated**

This was used downstream by email alerts service, which subscribes to RabbitMQ messages from publishing API. The fields now live in the `links` hash and email alerts service looks in both places.

## details.government

This is used to determine whether the document is in "history mode". If a document is political and was published by a previous government, a banner is displayed at the top of the page.

Comes from a `Government` object associated with the `Edition` 

See `political`.

Eg

```
"government": {
  "title": "2010 to 2015 Conservative and Liberal Democrat coalition government",
  "slug": "2010-to-2015-conservative-and-liberal-democrat-coalition-government",
  "current": false
}
```

## details.political

This is used in conjunction with `government` to determine whether the document is in "history mode".
Comes from the `Edition` in Whitehall.

Eg `"political": false`

## details.emphasised_organisations

This is used to tell which of the organisations in the `links` hash should appear first in the metadata component.

Eg `"emphasised_organisations": ["1994e0e4-bd19-4966-bbd7-f293d6e90a6b"]`

## details.body

This is the rendered HTML content of the govspeak for the content item.

It is generated in Whitehall using the `Whitehall::GovspeakRenderer#govspeak_edition_to_html` 
